{"componentChunkName":"component---src-templates-blog-template-js","path":"/aws-mfa-iam/","result":{"data":{"cur":{"id":"d8ab4a06-efe8-5de2-b792-950753187384","html":"<p>올해 서버가 필요한 일이 많아 마구잡이로 AWS 프리티어 계정을 생성하면서 나에게도 몇천만원이 결제되는 일이 생길까봐 걱정이 되기 시작했다..<br>\n<em>“설마 그럴일이 있겠어~”</em> 싶었지만 그게 바로 사망플래그라고 주변에서 경고해서 최소한의 보안을 위해 앞으로는 MFA, IAM을 설정해주려 한다.</p>\n<p>MFA, IAM을 설정하는 방법을 설명하기에 앞서 MFA와 IAM은 당최 무엇인가?<br>\n간단하게 말하자면 MFA(Multi-Facfor Authentication)는 로그인할 때 더 까다롭게 인증하는 것이고, IAM(Identity and Access Management)은 AWS의 모든 기능에 접근할 수 있는 루트 사용자 대신 특정 기능만 사용할 수 있도록 사용자를 생성하는 것이다.<br>\n따라서 루트 사용자 계정에는 MFA를 적용해 접근하기 어렵게 만들고, 대신 IAM으로 권한을 줄인 사용자 계정을 만들어 사용하면 해당 사용자 계정이 털리더라도 몇천만원이 털리지는 않게 피해를 줄일 수 있다.</p>\n<h2 id=\"루트-사용자에-mfa-활성화\" style=\"position:relative;\"><a href=\"#%EB%A3%A8%ED%8A%B8-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%97%90-mfa-%ED%99%9C%EC%84%B1%ED%99%94\" aria-label=\"루트 사용자에 mfa 활성화 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>루트 사용자에 MFA 활성화</h2>\n<p>보안 자격 증명 서비스에 들어갔을 때 루트 사용자에 MFA 할당을 안했다면 알아서 하라고 경고가 뜬다.<br>\n매우 친절하다. AWS에서도 내 계정이 털리지 않길 바라나 보다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAzElEQVQY05WPy2qFQBBE/f9/jEbj6LxfanAkci4zkkAWWWRx6KKapro6EyLaWFap8CEQU/oh5Uzetn/RSaV4H8fGW9/TDwPjNDEMA4sy+JgIKeNjJqREiPFP6gOdNoZJLMzS8iEt87IihGAWglVKlPUon5AuYqxDG029qSj9W9dW3e4dWUmMDyht0PpZ1rRSSuMqhfM8H31dj39d3PfN130/dfPGfhx0ewxkq3EhYJ3DeY9zvulaI8ZESrl53zqE2GYNOUvhOD4b277zAiGoe4YLiWfyAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"보안 자격 증명 탭의 MFA 활성화 경고\"\n        title=\"보안 자격 증명 탭의 MFA 활성화 경고\"\n        src=\"/static/065d8f8f0ccf23186a3f1ed997d23e0d/37523/mfa-alert.png\"\n        srcset=\"/static/065d8f8f0ccf23186a3f1ed997d23e0d/e9ff0/mfa-alert.png 180w,\n/static/065d8f8f0ccf23186a3f1ed997d23e0d/f21e7/mfa-alert.png 360w,\n/static/065d8f8f0ccf23186a3f1ed997d23e0d/37523/mfa-alert.png 720w,\n/static/065d8f8f0ccf23186a3f1ed997d23e0d/302a4/mfa-alert.png 1080w,\n/static/065d8f8f0ccf23186a3f1ed997d23e0d/dcccd/mfa-alert.png 1127w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>옆에 있는 MFA 할당 버튼을 누르거나 멀티 팩터 인증(MFA)를 직접 찾아서 활성화할 수도 있다.</p>\n<p>방법은 매우 간단하다.<br>\n모바일 디바이스 또는 컴퓨터 또는 기타 하드웨어 어쩌구를 이용해 인증하도록 설정해주면 된다.<br>\n사용하기 쉽게 폰에 Authenticator 앱을 설치하고 QR코드를 통해 연결해준다.<br>\n인증을 위해 MFA 숫자 두개를 입력하도록 하는데 앱의 MFA 숫자는 정해진 게 아니라 일정시간이 지나면 바뀌므로 바뀐 숫자를 추가로 입력해주면 된다.<br>\n그러면 MFA 활성화 완료~</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAvElEQVQY041RXQ+DIAzk//+87c3noZUI+IUIiLeURGPMEnfJhQttj7aInDOMMbDWYhiGovmOse974ROuOYKLG2qgVAutNaZpOhMOwzvvMQb7xBgh8p5hrClmtu/xD64dHdo5h67rIOa04KUquHEGEUFKCaUUFu+RUkKKqbzMms/7Ou5rES55vKmC1RYfKVHXDYgaUEtoW8LsHNZ1hfe+cNs28FRs/Isi5Q3Wj4ghnkV+WU6TEELp7ODTJ30BWiXVxTPdlrEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MFA 활성화 완료 화면\"\n        title=\"MFA 활성화 완료 화면\"\n        src=\"/static/1548f2e9db5d3552919c296f5a080ab5/37523/mfa-success.png\"\n        srcset=\"/static/1548f2e9db5d3552919c296f5a080ab5/e9ff0/mfa-success.png 180w,\n/static/1548f2e9db5d3552919c296f5a080ab5/f21e7/mfa-success.png 360w,\n/static/1548f2e9db5d3552919c296f5a080ab5/37523/mfa-success.png 720w,\n/static/1548f2e9db5d3552919c296f5a080ab5/f73a1/mfa-success.png 822w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"iam-사용자-설정\" style=\"position:relative;\"><a href=\"#iam-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%84%A4%EC%A0%95\" aria-label=\"iam 사용자 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IAM 사용자 설정</h2>\n<p>IAM 서비스에서 사용자를 추가한다.<br>\n이름은 적당히 정하면 되고 권한 설정이 중요하다.<br>\n여기서 머리가 좀 어지럽다. 권한이 너무 많아!<br>\n그렇다고 Full Access 또는 관리자 수준의 권한을 주면 사용자를 만든 의미가 없어진다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABeklEQVQoz41SC27rIBD0/U/Qe7wL9Aa9wWtUJf5gzC5gAzbYUy1NoqZ9kR7SCBavh2GGZgkRpRTIOI7jv/F7HEKApu97GGL4eUGMsSLnfMe2bQ+Qw1NKYLawbPDeTnh57fDnTdeDGssM6xxYZmvB1sI5B+99nZdlqQSCEMJXDzOICGQM9GTw96JxuijkXNB0XYfT6R1910GpAcMg6CHKBVIrpSpkLf3n8xlt216/DdCqR99dsK4rGvGQ1AfGiTBMHsPkoCaPZYlV1c2GG9aUqnI96lrXnqt6sagp+4HILdjO0HbFyBFu2Z6GJKN6SIx93++RyLpeecs7ArUw7KAoYuQA8glpzTiOvTZ+h5CKMjJUA7rtl2uITS47Incg9tA2YbKxIqRcf/4nYU2ZHwlLQRGFQhjoArIek03QHJG2Ut/VT7IHhUTYr4SyJ4R3hUJoyGHkBG0jeF4xh+2r+emVTSW5eftAGJ0CuxnGrXf/tlyeKpRQ5D3+9FDqT1FvVcavqfL3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"IAM 정책들\"\n        title=\"IAM 정책들\"\n        src=\"/static/80f3923408eb3249e818aaec2716b473/37523/iam-policies.png\"\n        srcset=\"/static/80f3923408eb3249e818aaec2716b473/e9ff0/iam-policies.png 180w,\n/static/80f3923408eb3249e818aaec2716b473/f21e7/iam-policies.png 360w,\n/static/80f3923408eb3249e818aaec2716b473/37523/iam-policies.png 720w,\n/static/80f3923408eb3249e818aaec2716b473/302a4/iam-policies.png 1080w,\n/static/80f3923408eb3249e818aaec2716b473/78797/iam-policies.png 1125w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>무려 1065개의 정책들…</p>\n<p>나는 AWS 프리티어 계정에 인스턴스를 딱 하나만 만들고 접속해서 사용하는 것이 목표다.<br>\n따라서 EC2 인스턴스 정보를 읽는 것과 해당 인스턴스에 연결하는 것만 가능하고 나머지는 다 제어하는 권한을 부여해야 한다.<br>\n직접 권한을 부여하는 방법도 있지만 난 이미 존재하는 정책을 적용해 사용자 그룹을 만들었다.</p>\n<ol>\n<li>AmazonEC2ReadOnlyAccess</li>\n<li>EC2InstanceConnect</li>\n</ol>\n<p>방금 만든 사용자 그룹에 해당하는 사용자를 생성한다.</p>\n<p>여기서 끝이 아니다.<br>\n콘솔로 접속할 수 있도록 콘솔 엑세스를 활성화해줘야 한다.<br>\n사용자의 보안 자격 증명 탭에서 콘솔 액세스를 활성화할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABjklEQVQoz5VSy24iMRD0l+8xlxw3UiLxHdySkAjBAWm1YhlIInFhERoEkwmZh992rbonMyFLLlgq2W633eWqFvOnF/z6PcXV1U8sl0vQCCHg3OGcQwgR4ubmGr1eD1JKPvDe84MxxrNQlBU/KrQ2XZVjZnRIMMbC2q+guCX8F/chQGTZK9brNVarFbbbLa83mw2kVKiqiqsT65Y5XSyrCkSE4yFwvD0XT8/PGA6HmEwmGI/HGI1GSJIEdS3xmucnelrrcDi8Q2l9oiMVF0VRdpT1UZLzvoszgw9dKSfP35h9w6pBx5AukE7GGEalLd6lgbEOSinWKsTIyS1itydDcIQIUZYl6rrmy+T0Pj8gzXJ2rZaSi1B194Fm7ZrZaRiVQqsNjNoyU7Hb7b7Vo9Xk2FnXOWtgbYBWKQ7pBfZ/f+AtvYT3EmI6/YN+v4+Hx0cMBgPc3t7xfHd/jyzL+GFius8yZvvZe4G/2RXntosQ1Cqz2Qzz+ZxBri8WC8ySBEVRcCKxIkna73+FZTjfmPcPs+xOyZVhZaEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"보안 자격 증명 탭의 콘솔 액세스 활성화 버튼\"\n        title=\"보안 자격 증명 탭의 콘솔 액세스 활성화 버튼\"\n        src=\"/static/62ba710ceb9b3ea33e2f6d15bd3a1d84/37523/iam-console-access.png\"\n        srcset=\"/static/62ba710ceb9b3ea33e2f6d15bd3a1d84/e9ff0/iam-console-access.png 180w,\n/static/62ba710ceb9b3ea33e2f6d15bd3a1d84/f21e7/iam-console-access.png 360w,\n/static/62ba710ceb9b3ea33e2f6d15bd3a1d84/37523/iam-console-access.png 720w,\n/static/62ba710ceb9b3ea33e2f6d15bd3a1d84/302a4/iam-console-access.png 1080w,\n/static/62ba710ceb9b3ea33e2f6d15bd3a1d84/ea64c/iam-console-access.png 1116w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이제 계정ID를 기억해두거나 콘솔 로그인 링크로 접속해 이 사용자로 콘솔 접속이 가능하다!<br>\n계정 ID나 콘솔 로그인 링크, 사용자 이름, 사용자 암호를 꼭 기억해두자.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%A3%A8%ED%8A%B8-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%97%90-mfa-%ED%99%9C%EC%84%B1%ED%99%94\">루트 사용자에 MFA 활성화</a></li>\n<li><a href=\"#iam-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%84%A4%EC%A0%95\">IAM 사용자 설정</a></li>\n</ul>\n</div>","excerpt":"올해 서버가 필요한 일이 많아 마구잡이로 AWS 프리티어 계정을 생성하면서 나에게도 몇천만원이 결제되는 일이 생길까봐 걱정이 되기 시작했다.. “설마 그럴일이 있겠어~” 싶었지만 그게 바로 사망플래그라고 주변에서 경고해서 최소한의 보안을 위해 앞으로는 MFA, IAM을 설정해주려 한다. MFA, IAM을 설정하는 방법을 설명하기에 앞서 MFA와 IAM은 당최 무엇인가? 간단하게 말하자면 MFA(Multi-Facfor Authentication)는 로그인할 때 더 까다롭게 인증하는 것이고, IAM(Identity and Access Management)은 AWS의 모든 기능에 접근할 수 있는 루트 사용자 대신 특정 기능만 사용할 수 있도록 사용자를 생성하는 것이다. 따라서 루트 사용자 계정에는 MFA를 적용해 접근하기 어렵게 만들고, 대신 IAM으로 권한을 줄인 사용자 계정을 만들어 사용하면 해당 사용자 계정이 털리더라도 몇천만원이 털리지는 않게 피해를 줄일 수 있다. 루트 사용자에…","frontmatter":{"date":"April 10, 2023","title":"AWS 보안 향상하기 - MFA, IAM","categories":"aws"},"fields":{"slug":"/aws-mfa-iam/"}},"next":{"id":"4fd083a3-112c-526f-bd73-807dc4d91ecb","html":"<p>React 18에서 가장 중요한 변화는 Concurrency, <strong>동시성</strong>입니다.<br>\n동시성이 적용되기 전 동기식 렌더링의 경우, 업데이트가 렌더링을 시작하면 사용자는 화면에서 결과를 볼 수 있을 때까지 아무것도 중단할 수 없습니다.<br>\n동시성이 적용된 후 렌더링은 중단될 수 있습니다.<br>\n(React 18로 업그레이드해도 createRoot 함수 등 동시성을 부여하는 기능을 사용하지 않으면 업그레이드 이전과 동일하게 동기적으로 렌더링합니다.)<br>\n동시 렌더링에서 리액트는 업데이트 렌더링을 시작하고, 중간에 일시중지한 다음 나중에 계속할 수 있습니다. 심지어 진행 중인 렌더링을 완전히 포기할 수 있습니다. 렌더링이 중단되더라도 UI가 일관되게 보일 것을 보장합니다.<br>\n이 기능을 통해 React는 메인 스레드를 차단하지 않고 백그라운드에서 새로운 화면을 준비할 수 있으며, 이것은 UI가 큰 렌더링 작업의 중간에 있더라도 사용자 입력에 즉시 응답하여 유동적인 사용자 경험을 만들 수 있다는 것을 의미합니다.</p>\n<h2 id=\"automatic-batching\" style=\"position:relative;\"><a href=\"#automatic-batching\" aria-label=\"automatic batching permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Automatic Batching</h2>\n<p>여러 상태 업데이트를 단일 재랜더링으로 그룹화하여 일괄 처리합니다.<br>\n업데이트 이전에는 React 이벤트 핸들러 내에서만 업데이트를 일괄 처리하고, Promise, setTimeout, 네이티브 이벤트 핸들러 또는 기타 이벤트 내부의 업데이트는 일괄적으로 처리되지 않았습니다.<br>\nReact 18은 이런 업데이트도 자동으로 일괄 처리됩니다.</p>\n<p>Before</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// 오직 React 이벤트만 일괄 처리</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">f</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// setCount와 setFlag가 일괄 처리되지 않고 각각 업데이트</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>After</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// Promise, setTimeout의 내부, 네이티브 이벤트 핸들러, 기타 이벤트가 일괄 처리됨</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">f</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// setCount와 setFlag가 일괄 처리되어 한번만 업데이트</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>만약 자동 일괄 처리가 안되게 하고 싶다면 flushSync를 사용할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> flushSync <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">handleClick</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">flushSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> c <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// React has updated the DOM by now</span>\n  <span class=\"token function\">flushSync</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">f</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// React has updated the DOM by now</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"transitions\" style=\"position:relative;\"><a href=\"#transitions\" aria-label=\"transitions permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Transitions</h2>\n<p>긴급 업데이트와 긴급하지 않은 업데이트를 구분하기 위해 도입된 개념입니다.<br>\n긴급한 업데이트와 긴급하지 않은 업데이트를 구분하여 처리하는 이유는 다음과 같습니다.<br>\n예를 들어, 간단한 추천검색어를 보여주는 검색창이 있을 때 검색창에 글자를 타이핑하는 것 검색창을 클릭하는 것과 같은 업데이트는 즉각적인 응답이 필요합니다. 하지만 추천검색어를 나타내는 업데이트의 경우 사용자가 즉각적인 응답을 기대하지 않기 때문에 덜 긴급하게 동작해도 괜찮습니다.<br>\n따라서 긴급 업데이트와 긴급하지 않은 업데이트를 구분해 처리한다면 사용자 경험을 좀 더 매끄럽게 만들 수 있습니다.<br>\n보통 입력, 클릭, 누르기 등 직접적인 상호작용은 긴급 업데이트로, 화면이 다른 화면으로 <strong>전환</strong>되는 것은 긴급하지 않은 업데이트로 처리합니다.<br>\n(이 기능의 이름이 Transition인 이유도 React 측에서 UI <strong>전환</strong>과 관련된 업데이트가 긴급하지 않은 업데이트라고 생각하기 때문인 것 같습니다.)<br>\n이전에는 debouncing, throttling과 같은 방법을 사용해서 업데이트를 일부러 늦추곤 했지만 React 18의 Transition을 사용하면 좀 더 간단하게 사용할 수 있습니다.</p>\n<p>Transition 기능을 사용하려면 startTransition API를 사용해 React에게 어떤 것이 긴급 업데이트이고 어떤 것이 전환 업데이트인지 알려야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> startTransition <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 긴급 업데이트</span>\n<span class=\"token function\">setInputValue</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 전환 업데이트 (긴급하지 않은 업데이트)</span>\n<span class=\"token function\">startTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setSearchQuery</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>startTransition으로 감싸진 업데이트는 긴급하지 않은 것으로 처리되고 감싸지지 않은 업데이트는 긴급 업데이트로 처리됩니다.<br>\n긴급 업데이트가 시작되어 전환 업데이트가 중단되면, React는 완료되지 않은 오래된 렌더링 작업을 버리고 최신 업데이트만 렌더링합니다.</p>\n<ul>\n<li>useTransition: isPending 값과 startTransition 함수를 반환하는 <strong>hook</strong></li>\n<li>startTransition: Transition을 시작하는 <strong>함수</strong></li>\n</ul>\n<p>startTransition만 단독으로 사용할 수도 있지만 useTransition이라는 react hook을 사용할 수도 있습니다.<br>\nuseTransition은 isPending 값과 startTransition 함수를 반환한다. isPending은 보류중인 전환이 있는지를 나타내는 boolean 값입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useTransition <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">TabContainer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isPending<span class=\"token punctuation\">,</span> startTransition<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>tab<span class=\"token punctuation\">,</span> setTab<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'about'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">selectTab</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextTab</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">startTransition</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setTab</span><span class=\"token punctuation\">(</span>nextTab<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"suspense\" style=\"position:relative;\"><a href=\"#suspense\" aria-label=\"suspense permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Suspense</h2>\n<p>Suspense를 사용해 UI 로딩상태를 선언적으로 지정할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span> <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Spinner</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Comments</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Suspense 기능은 이전에도 존재했습니다만, React 18에서 서버에 대한 지원이 추가되고 동시 렌더링 기능을 사용한 기능이 확장되었습니다.<br>\n또 Transition API와 결합되어 사용될 때 가장 잘 작동합니다. 잘못된 로딩 상태를 방지하기 위해 충분한 데이터가 로드될 때까지 렌더링을 지연시킬 것입니다.</p>\n<h2 id=\"react-dom-client\" style=\"position:relative;\"><a href=\"#react-dom-client\" aria-label=\"react dom client permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>React DOM Client</h2>\n<p>React DOM Client 관련 API가 수정되었으며 이제 <code class=\"language-text\">react-dom</code>이 아닌 <code class=\"language-text\">react-dom/client</code>에서 내보내집니다.<br>\n<strong>해당 API를 사용하지 않으면 React 18의 새로운 기능들이 작동하지 않습니다.</strong></p>\n<ul>\n<li><code class=\"language-text\">ReactDOM.render</code> → <code class=\"language-text\">createRoot</code></li>\n<li><code class=\"language-text\">ReactDOM.hydrate</code> → <code class=\"language-text\">hydrateRoot</code></li>\n</ul>\n<ul>\n<li>creatRoot: render하거나 unmount할 root를 만드는 새로운 메소드</li>\n<li>hydrateRoot: 서버 렌더링 어플리케이션을 hydrate하는 새로운 메소드</li>\n</ul>\n<p>이전의 루트 관리</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> render <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token attr-name\">tab</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>home<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span> container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">unmountComponentAtNode</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>React 18에서의 루트 관리</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createRoot <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/client'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> root <span class=\"token operator\">=</span> <span class=\"token function\">createRoot</span><span class=\"token punctuation\">(</span>container<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// createRoot(container!) if you use TypeScript</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">App</span></span> <span class=\"token attr-name\">tab</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>home<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nroot<span class=\"token punctuation\">.</span><span class=\"token function\">unmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"strict-mode\" style=\"position:relative;\"><a href=\"#strict-mode\" aria-label=\"strict mode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Strict Mode</h2>\n<p>앞으로 React는 컴포넌트가 unmount 사이에서 상태를 보존하는 기능을 제공할 예정입니다.<br>\n이를 위해 React는 전과 동일한 컴포넌트 상태를 사용해서 트리를 unmount하고 remount해야 합니다.<br>\n그에 대비해서 React는 Strict Mode에 새로운 개발 전용 검사를 도입했습니다.</p>\n<p>React 18의 Strict Mode에서는 컴포넌트가 처음에 mount될때마다 자동으로 모든 컴포넌트들을 unmount했다가 다시 mount해서 두번째 mount에서 이전 상태를 복원합니다.</p>\n<p>이전에는, React는 컴포넌트를 mount하고 effect를 만들었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">*</span> React mounts the component<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Layout effects are created<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Effects are created<span class=\"token punctuation\">.</span></code></pre></div>\n<p>React 18의 Strict Mode에서는, React는 개발 모드에서 컴포넌트를 unmount하고 다시 mount하는 것을 시뮬레이션합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token operator\">*</span> React mounts the component<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Layout effects are created<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Effects are created<span class=\"token punctuation\">.</span>\n<span class=\"token operator\">*</span> React simulates unmounting the component<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Layout effects are destroyed<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Effects are destroyed<span class=\"token punctuation\">.</span>\n<span class=\"token operator\">*</span> React simulates mounting the component <span class=\"token keyword\">with</span> the previous state<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Layout effects are created<span class=\"token punctuation\">.</span>\n  <span class=\"token operator\">*</span> Effects are created<span class=\"token punctuation\">.</span></code></pre></div>\n<h2 id=\"new-hooks\" style=\"position:relative;\"><a href=\"#new-hooks\" aria-label=\"new hooks permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>New Hooks</h2>\n<h3 id=\"useid\" style=\"position:relative;\"><a href=\"#useid\" aria-label=\"useid permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useId</h3>\n<p>hydration 불일치를 피하면서 클라이언트와 서버 모두에서 고유한 ID를 생성하는 hook입니다.<br>\nlist의 key를 생성하기 위한 기능이 아닙니다. list의 key는 데이터로부터 만들어져야 합니다.</p>\n<h3 id=\"usetransition\" style=\"position:relative;\"><a href=\"#usetransition\" aria-label=\"usetransition permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useTransition</h3>\n<p>useTransition과 startTransition을 사용하면 일부 상태 업데이트를 긴급하지 않은 것으로 표시할 수 있습니다. 표시하지 않은 다른 상태 업데이트들은 기본적으로 긴급한 것으로 간주됩니다.</p>\n<h3 id=\"usedeferredvalue\" style=\"position:relative;\"><a href=\"#usedeferredvalue\" aria-label=\"usedeferredvalue permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useDeferredValue</h3>\n<p>UI의 일부 업데이트를 연기할 수 있는 hook입니다. 트리의 긴급하지 않은 부분을 다시 렌더링하는 것을 연기할 수 있습니다.<br>\ndebouncing과 달리 고정된 시간 지연이 없습니다.</p>\n<h3 id=\"usesyncexternalstore\" style=\"position:relative;\"><a href=\"#usesyncexternalstore\" aria-label=\"usesyncexternalstore permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useSyncExternalStore</h3>\n<p>외부 저장소가 저장소에 대한 업데이트를 동기화하도록 강요하여 동시 읽기를 지원할 수 있는 hook입니다.<br>\n어플리케이션 코드가 아닌 라이브러리에서 사용하기 위한 hook입니다.</p>\n<h3 id=\"useinsertioneffect\" style=\"position:relative;\"><a href=\"#useinsertioneffect\" aria-label=\"useinsertioneffect permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useInsertionEffect</h3>\n<p>CSS-in-JS 라이브러리가 렌더링에 스타일을 삽입하는 성능 문제를 해결할 수 있는 hook입니다.<br>\n어플리케이션 코드가 아닌 라이브러리에서 사용하기 위한 hook입니다.</p>\n<h2 id=\"typescript-정의-업데이트\" style=\"position:relative;\"><a href=\"#typescript-%EC%A0%95%EC%9D%98-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8\" aria-label=\"typescript 정의 업데이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TypeScript 정의 업데이트</h2>\n<p>TypeScript를 사용한다면, <code class=\"language-text\">@types/react</code>와 <code class=\"language-text\">@types/react-dom</code> 디펜던시를 최신 버전으로 업데이트해야 합니다.<br>\n이제 컴포넌트의 prop들을 정의할 때 <code class=\"language-text\">children</code> prop을 명시적으로 나열해야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">MyButtonProps</span> <span class=\"token punctuation\">{</span>\n  color<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  children<span class=\"token operator\">?</span><span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span>ReactNode<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"인터넷-익스플로러-지원-중단\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%ED%84%B0%EB%84%B7-%EC%9D%B5%EC%8A%A4%ED%94%8C%EB%A1%9C%EB%9F%AC-%EC%A7%80%EC%9B%90-%EC%A4%91%EB%8B%A8\" aria-label=\"인터넷 익스플로러 지원 중단 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>인터넷 익스플로러 지원 중단</h2>\n<p>React 18에 도입된 새로운 기능이 IE에서 적절하게 폴리필할 수 없는 마이크로태스크와 같은 최신 브라우저 기능을 사용하여 구축되었기 때문에 더 이상 인터넷 익스플로러에 대한 지원이 중단됩니다.<br>\n인터넷 익스플로러를 지원해야 한다면 React 17을 사용하는 것이 좋습니다.<br>\n(인터넷 익스플로러는 2022년 6월 15일부터 지원이 중단되었습니다.)</p>\n<h2 id=\"그-외-주목할-만한-변화들\" style=\"position:relative;\"><a href=\"#%EA%B7%B8-%EC%99%B8-%EC%A3%BC%EB%AA%A9%ED%95%A0-%EB%A7%8C%ED%95%9C-%EB%B3%80%ED%99%94%EB%93%A4\" aria-label=\"그 외 주목할 만한 변화들 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그 외 주목할 만한 변화들</h2>\n<ul>\n<li><strong>컴포넌트의 <code class=\"language-text\">undefined</code> 렌더링</strong>: 컴포넌트에서 <code class=\"language-text\">undefined</code>를 반환해도 더 이상 경고하지 않습니다. 그렇기 때문에 관련 오류를 방지하기 위해서 linter를 설정할 것을 권고합니다.</li>\n<li><strong>mount되지 않은 컴포넌트의 setState 호출에 대한 경고 사라짐</strong></li>\n<li><strong>콘솔 로그 억제 제거</strong>: Strict Mode를 사용할 때, React는 예상치 못한 부작용을 찾을 수 있도록 각 구성 요소를 두 번 렌더링합니다. React 17에서, 로그를 쉽게 읽을 수 있도록 두 렌더링 중 하나에 대한 콘솔 로그를 억제했습니다. React 18에서는 이러한 콘솔 로그 억제가 사라집니다. 대신 React DevTools가 설치되어 있다면, 두번째 로그의 렌더링은 회색으로 표시되며, 이를 완전히 억제할 수 있는 옵션이 제공됩니다.</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#automatic-batching\">Automatic Batching</a></p>\n</li>\n<li>\n<p><a href=\"#transitions\">Transitions</a></p>\n</li>\n<li>\n<p><a href=\"#suspense\">Suspense</a></p>\n</li>\n<li>\n<p><a href=\"#react-dom-client\">React DOM Client</a></p>\n</li>\n<li>\n<p><a href=\"#strict-mode\">Strict Mode</a></p>\n</li>\n<li>\n<p><a href=\"#new-hooks\">New Hooks</a></p>\n<ul>\n<li><a href=\"#useid\">useId</a></li>\n<li><a href=\"#usetransition\">useTransition</a></li>\n<li><a href=\"#usedeferredvalue\">useDeferredValue</a></li>\n<li><a href=\"#usesyncexternalstore\">useSyncExternalStore</a></li>\n<li><a href=\"#useinsertioneffect\">useInsertionEffect</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#typescript-%EC%A0%95%EC%9D%98-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8\">TypeScript 정의 업데이트</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B8%ED%84%B0%EB%84%B7-%EC%9D%B5%EC%8A%A4%ED%94%8C%EB%A1%9C%EB%9F%AC-%EC%A7%80%EC%9B%90-%EC%A4%91%EB%8B%A8\">인터넷 익스플로러 지원 중단</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B7%B8-%EC%99%B8-%EC%A3%BC%EB%AA%A9%ED%95%A0-%EB%A7%8C%ED%95%9C-%EB%B3%80%ED%99%94%EB%93%A4\">그 외 주목할 만한 변화들</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"April 06, 2023","title":"리액트 v18.0","categories":"react"},"fields":{"slug":"/react-v18/"}},"prev":{"id":"c456e1a0-6b34-5e13-9a9e-9dde2bb5400f","html":"<p>무한 렌더링하는 컴포넌트를 정말 필요한 때에만 리렌더링하도록 최적화해봤습니다.</p>\n<ol>\n<li>무한 렌더링을 탈출한 후,</li>\n<li><code class=\"language-text\">useCallback</code>과 <code class=\"language-text\">React.memo</code>를 이용해 리렌더링을 최적화합니다.</li>\n</ol>\n<h2 id=\"무한-렌더링-탈출하기\" style=\"position:relative;\"><a href=\"#%EB%AC%B4%ED%95%9C-%EB%A0%8C%EB%8D%94%EB%A7%81-%ED%83%88%EC%B6%9C%ED%95%98%EA%B8%B0\" aria-label=\"무한 렌더링 탈출하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>무한 렌더링 탈출하기</h2>\n<p>프로젝트는 간단한 투두리스트 앱으로 이렇게 생겼습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABlElEQVQ4y52TzW7aQBRG/f6v0F33XfQBuui2baQADZikSvAftoES7PHYc2cGTmVDIlpB1WZxpG905x59s5igEyErSp7ihFprrPcYazHOXaafv+T+nnUorRBrEGsJpK4oZiHRaEyTJLjVCikLbFleJk2xeT4gZYlflzyOfhBPY7w1BFKucEmGWxb4ZcH+b+Ql++9T9l+/DbibW9jkfPwQ8f7dDPZt33CFZLfIcjxgr5FPzphil3fYbIzLJ6hohIonWKMJbJvSbEOe1yFWR2AzDpKecTz7LsF3Gb76gt9+wj9/xtc3eJMNe1bNEFMRWJ2it3Oq9T1qc0+9nlNvTvlEn61a4HSCU4+43QhXjXHqAadjTB1hdn8IXyWDcH5FGB+lOjvR5whREVKdhDIIw2F4MBmHLr2I1wlexxcRFZ8Jm4Ru94BtomOD5gr6OrY5E/ZPbjazobZvX1ok/8ixoal/axjTbkOkfsLrCNcs/htTL5DdHdLtCKQtaH+OkSrEqfmbGNr1QqMI+v8oVhAxmDfS7/aO3vULUxzaGdq/DLEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"투두리스트 앱 화면 구조\"\n        title=\"투두리스트 앱 화면 구조\"\n        src=\"/static/4acad27e6dac26b32aec58a3d63e1e59/37523/todolist-structure.png\"\n        srcset=\"/static/4acad27e6dac26b32aec58a3d63e1e59/e9ff0/todolist-structure.png 180w,\n/static/4acad27e6dac26b32aec58a3d63e1e59/f21e7/todolist-structure.png 360w,\n/static/4acad27e6dac26b32aec58a3d63e1e59/37523/todolist-structure.png 720w,\n/static/4acad27e6dac26b32aec58a3d63e1e59/302a4/todolist-structure.png 1080w,\n/static/4acad27e6dac26b32aec58a3d63e1e59/d073d/todolist-structure.png 1297w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>백엔드 서버에 API 요청을 해서 투두리스트 관련 데이터를 다루고 있습니다.</p>\n<p>TodoList 컴포넌트에서 투두 리스트 데이터를 받아와 화면에 보여줘야 하는데 그러면 API 요청이 필수적입니다.<br>\n투두 리스트를 가장 최신 상태로 유지하는 것이 가장 좋지만 그러면 API 요청이 잦아지고 컴포넌트의 리렌더링도 잦아질수 있어 성능이 크게 떨어집니다.<br>\n따라서 API 요청 자체를 최적화해야 합니다.</p>\n<p>최적화 전의 TodoList 컴포넌트는 이런 식으로 데이터를 받아오고 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">TodoList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todoList<span class=\"token punctuation\">,</span> setTodoList<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useState</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Todo<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchTodoList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setTodoList</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getTodos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">fetchTodoList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 후략</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>네, 맞습니다. 무한으로 데이터를 받아오는 최악의 상태입니다.<br>\n<code class=\"language-text\">useEffect</code> 함수 안에서 <code class=\"language-text\">setTodoList</code> 함수를 통해 상태를 변화시키므로 TodoList 컴포넌트는 다시 렌더링되고 그러면 <code class=\"language-text\">useEffect</code> 함수가 또 다시 실행되어 무한으로 즐기게 됩니다.</p>\n<p>이 무한 렌더링 상태에서 벗어나기 위해 두 가지 방법을 생각했습니다.</p>\n<ol>\n<li>\n<p>투두리스트 데이터를 받아올 타이밍을 다루는 상태를 만들어서 관리하기<br>\n투두리스트 리렌더링 관련 상태를 만들어서 사용자가 투두를 생성했을 때, 수정했을 때, 삭제했을 때 등 특정 이벤트가 발생했을 때만 투두 리스트 데이터를 요청해서 리렌더링합니다.</p>\n</li>\n<li>\n<p>투두리스트 데이터를 상태로 관리하며 API 요청을 줄이기<br>\n투두리스트가 처음 렌더링되었을 때 최초 한번만 데이터를 fetch하여 받아옵니다. 해당 데이터를 state로 관리하며 사용자가 투두를 생성했을 때, 수정했을 때, 삭제했을 때 등 특정 이벤트가 발생했을 때 서버에 투두 리스트 데이터를 요청하여 데이터를 받아오는 대신 관리하던 투두리스트 상태를 기반으로 리렌더링합니다.</p>\n</li>\n</ol>\n<p>두 방법 모두 특정 이벤트에만 컴포넌트가 리렌더링되는 것은 같습니다만, 2번 방법이 투두 리스트 데이터를 받아오기 위한 API 요청이 줄어든다는 장점이 있습니다.<br>\n하지만 동시에 데이터 일관성을 보장할 수 없다는 것을 의미합니다.<br>\n투두리스트 앱 특성상 여러명이 사용할 일은 없지만 데이터 일관성을 유지하는 것이 추후 개발에 혼란을 야기하지 않을 것 같아 1번 방법을 선택했습니다.</p>\n<p>TodoList를 리렌더링하는 타이밍을 알려줄 상태를 하나 만들고, 그 상태를 변화시킬 수 있는 함수를 TodoInput 컴포넌트와 Todo 컴포넌트에 전달합니다.<br>\n투두리스트 리렌더링을 관리하는 컴포넌트를 새로 하나 만들고 TodoRerender라고 이름지었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">TodoRerender</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>rerenderFlag<span class=\"token punctuation\">,</span> setRerenderFlag<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">seState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rerender</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setRerenderFlag</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>rerenderFlag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoInput</span></span> <span class=\"token attr-name\">rerender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>rerender<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodoList</span></span> <span class=\"token attr-name\">rerenderFlag</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>rerenderFlag<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">rerender</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>rerender<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그러면 TodoInput 컴포넌트를 통해 투두를 생성할 때, Todo 컴포넌트를 통해 투두를 수정할 때와 삭제할 때 상태를 변화시켜 TodoList 리렌더링을 통제할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">TodoList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\trerenderFlag<span class=\"token punctuation\">,</span>\n\trerender<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> TodoListComponent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>todoList<span class=\"token punctuation\">,</span> setTodoList<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">useState</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Todo<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchTodoList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token function\">setTodoList</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> <span class=\"token function\">getTodos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token function\">fetchTodoList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>rerenderFlag<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>w-full mt-10 space-y-6<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n\t\t\t</span><span class=\"token punctuation\">{</span>todoList\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">reverse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>todo <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n\t\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Todo</span></span>\n\t\t\t\t\t\t<span class=\"token attr-name\">key</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span></span>\n\t\t\t\t\t\t<span class=\"token attr-name\">todo</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">}</span></span>\n\t\t\t\t\t\t<span class=\"token attr-name\">rerenderTodoList</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>rerender<span class=\"token punctuation\">}</span></span>\n\t\t\t\t\t<span class=\"token punctuation\">/></span></span>\n\t\t\t\t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n\t\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n\t\t);\n};</span></code></pre></div>\n<p>이렇게 수정한 투두리스트 앱을 테스트해보면 무한 렌더링은 벗어났지만 문제가 하나 있습니다.<br>\nTodoList 컴포넌트를 리렌더링할 때마다 상관없는 TodoInput 컴포넌트까지 같이 리렌더링됩니다.</p>\n<h2 id=\"usecallback과-reactmemo를-이용해-리렌더링-최적화하기\" style=\"position:relative;\"><a href=\"#usecallback%EA%B3%BC-reactmemo%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4-%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81-%EC%B5%9C%EC%A0%81%ED%99%94%ED%95%98%EA%B8%B0\" aria-label=\"usecallback과 reactmemo를 이용해 리렌더링 최적화하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useCallback과 React.memo를 이용해 리렌더링 최적화하기</h2>\n<p><img src=\"/a2fbbf41e6eb82f819448d1059ab0876/rendering-test.gif\" alt=\"투두리스트 앱 리렌더링 화면\"></p>\n<p>이런 불필요한 리렌더링이 발생하는 이유는 다음과 같습니다.</p>\n<p>기본적으로 컴포넌트는 state가 변했을 때 리렌더링됩니다.<br>\n그리고 상위 컴포넌트가 리렌더링된다면 그에 따라 하위 컴포넌트도 리렌더링됩니다.</p>\n<p>따라서, TodoList 컴포넌트에서 TodoRerender의 상태를 변경시켰으므로 하위 컴포넌트인 TodoInput 컴포넌트와 TodoList 컴포넌트 모두 리렌더링되는 것입니다.</p>\n<p>실제로는 TodoInput 컴포넌트가 변하지 않는데 불필요하게 리렌더링되는 것이므로 이러한 리렌더링을 방지할 것입니다.</p>\n<ol>\n<li>TodoInput 컴포넌트의 props가 변하지 않았다면 TodoInput 컴포넌트를 리렌더링하지 않도록 방지하기</li>\n<li>TodoRerender 컴포넌트에서 TodoInput 컴포넌트로 넘겨주는 rerender 함수가 다른 값으로 인식되지 않도록 만들기</li>\n</ol>\n<p>1번 방법을 위해서는 <code class=\"language-text\">React.memo</code>를, 2번 방법을 위해서는 <code class=\"language-text\">useCallback</code>을 사용할 것입니다.</p>\n<blockquote>\n<p>💡 <strong>React.memo</strong><br>\n컴포넌트의 props가 변하지 않았다면 해당 컴포넌트의 리렌더링을 방지하는 Built-in React API</p>\n</blockquote>\n<blockquote>\n<p>💡 <strong>useCallback</strong><br>\n함수를 재사용할 수 있는 React hook<br>\n이 hook을 사용하면 컴포넌트가 리렌더링되더라도 해당 함수의 내용이 변하지 않았다면 함수를 새로 만들지 않는다.<br>\n(원래는 컴포넌트가 리렌더링되면 그 컴포넌트 안의 함수도 전부 새로 만들어진다.)<br>\n하지만 함수 내용이 실제로 변했을 때는 함수가 새로 만들어져야 하기 때문에 <code class=\"language-text\">[]</code>로 dependencies를 명시해서 해당 디펜던시 배열 안의 값 중 변한 게 있다면 함수가 새로 만들어지도록 해줘야 한다.</p>\n</blockquote>\n<p>먼저 TodoInput 컴포넌트를 <code class=\"language-text\">React.memo</code> 함수로 감싸 props인 rerender 함수가 변하지 않았다면 리렌더링되지 않도록 만듭니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">TodoInput</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> rerender <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> TodoInputComponent<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 중략</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">memo</span><span class=\"token punctuation\">(</span>TodoInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>그리고 TodoRerender 컴포넌트의 render 함수가 재사용될 수 있도록 useCallback 함수를 이용합니다.<br>\n추가적으로 상태를 업데이트할 때 상태를 직접 이용하지 않고 이전 상태를 이용하도록 구현하여 디펜던시를 줄였습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">TodoRerender</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>rerenderFlag<span class=\"token punctuation\">,</span> setRerenderFlag<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> rerender <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setRerenderFlag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>prevRerenderFlag<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>prevRerenderFlag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 후략</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 하면 투두리스트 데이터를 렌더링할 때 TodoList 컴포넌트만 리렌더링되고 TodoInput 컴포넌트는 그대로 둘 수 있습니다.</p>\n<blockquote>\n<p>⚠️ <strong>React DevTools를 이용할 때의 주의점</strong><br>\nReact DevTools를 통해 컴포넌트 렌더링을 측정할 때 위에 서술된 방법으로 최적화를 진행해도 TodoInput 컴포넌트가 리렌더링되는 것처럼 보여줍니다.\n하지만 직접 console을 찍어보면 TodoInput 컴포넌트가 렌더링 최적화된 것을 알 수 있습니다.\n왜 이렇게 동작하는 지는 알 수 없지만 도구에만 의존하지 않고 의문이 되는 부분은 따로 체크하는 습관을 들이는 것이 좋을 것 같습니다.</p>\n</blockquote>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%AC%B4%ED%95%9C-%EB%A0%8C%EB%8D%94%EB%A7%81-%ED%83%88%EC%B6%9C%ED%95%98%EA%B8%B0\">무한 렌더링 탈출하기</a></li>\n<li><a href=\"#usecallback%EA%B3%BC-reactmemo%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4-%EB%A6%AC%EB%A0%8C%EB%8D%94%EB%A7%81-%EC%B5%9C%EC%A0%81%ED%99%94%ED%95%98%EA%B8%B0\">useCallback과 React.memo를 이용해 리렌더링 최적화하기</a></li>\n</ul>\n</div>","frontmatter":{"date":"May 24, 2023","title":"리액트 렌더링 최적화하기","categories":"react"},"fields":{"slug":"/react-rendering-optimization/"}},"site":{"siteMetadata":{"siteUrl":"https://heony704.github.io","comments":{"utterances":{"repo":"heony704/heony704.github.io"}}}}},"pageContext":{"slug":"/aws-mfa-iam/","nextSlug":"/react-v18/","prevSlug":"/react-rendering-optimization/"}},"staticQueryHashes":["161131432","1956554647","2938748437"]}