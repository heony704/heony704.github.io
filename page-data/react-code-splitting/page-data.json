{"componentChunkName":"component---src-templates-blog-template-js","path":"/react-code-splitting/","result":{"data":{"cur":{"id":"f9e50ffe-ba8a-5116-a828-c25e9ea921c7","html":"<p>React 프로젝트를 최적화하는 방법 중 코드 분할과 지연 로딩에 대해 알게 되었다.</p>\n<blockquote>\n<p>💡 <strong>코드 분할(Code splitting)이란?</strong><br>\n하나의 빌드 파일을 한 번에 다운로드하는 대신 여러 파일로 분할해 필요할 때만 다운로드하는 것이다.\n초기 리소스 다운로드 시간을 줄일 수 있다.\n불필요한 코드 또는 중복되는 코드 없이 적절한 사이즈의 코드가 적절한 타이밍에 로드되는 것이 중요하다.</p>\n</blockquote>\n<blockquote>\n<p>💡 <strong>지연 로딩(Lazy loading)이란?</strong><br>\n처음 페이지가 로드될 때가 아닌, 사용자가 서비스를 이용하는 중 해당 코드가 필요해지는 시점에 분할되어 있던 코드가 로드되어 실행되는 것이다.\n처음에 한 번에 로드되지 않고 지연되었다가 로드되므로 지연 로딩이다.</p>\n</blockquote>\n<p>따로 코드 분할하지 않으면 통합된 하나의 빌드 파일을 가지게 되는데, 그러면 처음 페이지에 접속할 때 그 통합된 빌드 파일을 로드하기 때문에 당장 필요하지 않은 코드까지도 로드하게 된다.</p>\n<p>내 투두리스트 프로젝트에서도 투두리스트 페이지에 들어가든, 로그인/회원가입 페이지에 들어가든 <code class=\"language-text\">main.어쩌구저쩌구.js</code>라는 똑같은 하나의 빌드 파일을 로드한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABJ0AAASdAHeZh94AAACoklEQVQ4y01Ty3LdIAz1Z7TLxA9sbAMG22Djdx532pmki276CV31/3enI90004VGgIR0dCQlL8eO87wQ44p1XbFtG5ZlxbfnFbfv79jPF+zbhuu8ME0TjuNgiTFiHEf4acGyLIjLwv+TqR+gdAfZajRti1Zp+ClijxbHviCuO5Z1RZhmuH6AD9OHBJRlBVEUKIoCZVnCGIMkf/2Ffr2wnU+wYUE/rzBDgB5mWB/hwsJ3M04I6wEXIuJ+QfUeqnPoug4hBPT9wIGTaZqxrRvGYeQyvPew1qJpGnZuleLMWmsopWG0Qdu27EO673sopfhOgRPlHewWUU+WyzCccWIHCk4fSA/DgGEYmTdCQ3ySjYI0Hwmcc0iodtnWEKVAlmUMm6Sqqk9uSIQo/zsL5HnOmv7ID997ycuOzhIXDtb10KZj0pU2GEbPjRh9QFlJtjWt4jPZ57jADSPs6FHJmpEm87Rh51E4sW47us5ySWR0fY9hHDHPkRETykIISCm56zRu23Gg7A2jFWWJ5OU48Hq74Xa7MVd1Lbk5xAfN5HmeeHt75zuRT0JnAkD247qgZg/V3m3JMi9cVlVJRvDw8AhrHZdFCMl2PT0z0izP8ZimSLMcnbXYKeh+IG8bpGmGNMuQOGuYO7rQI33Q2nCCumlQ1w0HKwpx9+HGCaaFNmoMAZlpkKUZNyhZ48ykPz6mLISQnGXdMFLilBCSzrKck+ZFAe8Dvx/niUIppEWFNC+QWB94nkxnYZ1jZDTAtFZKax5sQjLHyMioAhoPGnqeBNshnS98+fkHX3/8RkKdqeuaN4M0d0uIzxmkM9uaBnkhmEfSlZS8x5L+ixKCelBJJJ25r9K/daJO0ZoRgvv6mXt3a4lBN3AkqoZpJKRqURnNyaqyZPkLkFfYz0Mdz8kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"코드 분할 전 빌드 파일\"\n        title=\"코드 분할 전 빌드 파일\"\n        src=\"/static/5f686c3e2602622cbf5f93a04f8b2af4/37523/build-file-before-code-splitting.png\"\n        srcset=\"/static/5f686c3e2602622cbf5f93a04f8b2af4/e9ff0/build-file-before-code-splitting.png 180w,\n/static/5f686c3e2602622cbf5f93a04f8b2af4/f21e7/build-file-before-code-splitting.png 360w,\n/static/5f686c3e2602622cbf5f93a04f8b2af4/37523/build-file-before-code-splitting.png 720w,\n/static/5f686c3e2602622cbf5f93a04f8b2af4/47ff6/build-file-before-code-splitting.png 852w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>투두리스트 페이지에 들어가도 불필요한 로그인 기능까지 같이 로드되는 것이다.</p>\n<p>그래서 빌드 파일을 분할해 필요한 코드만 로드하고 나머지는 필요할 때 로드하도록 지연하는 과정을 정리해봤다.</p>\n<h2 id=\"빌드-파일-분석하기\" style=\"position:relative;\"><a href=\"#%EB%B9%8C%EB%93%9C-%ED%8C%8C%EC%9D%BC-%EB%B6%84%EC%84%9D%ED%95%98%EA%B8%B0\" aria-label=\"빌드 파일 분석하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>빌드 파일 분석하기</h2>\n<p>그래서 빌드 파일 안이 도대체 어떻게 생겼는데?<br>\n불필요한 코드가 있는지 한번 직접 알아보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB3ElEQVQ4y42T2W7bMBBF8y+2RHFfRqRWK0Ec20Fa9KH9/2+5BSk5KWK36cPFDKmZg8sh9XB8OeF4+YHT20+c3n7h8fmMcZxwOBwwTRPmeS7xmuf9cRxLzOucd11XdLlc8FCzBkpbkEsY2wFjbGGNhlIKSiroHDdprWGNgZQSxpiyFkKgaRrsdjssy4KHvMgSjUAMhD4GWGXBhUTDeVFd12CMlXgvz/05TymtQM45GGvAJIdxhOifkLonxG5GSmNxcW38mzIwxvgBzDE3sbqGEApOJ5AbMA2E2Hq0bSxzyse9B78LrGsGYzRCcKvrJjeyG8B/A3OhkALe2+Iu0ghr7eqcbSfYYJ+hd4HXQq0lgh2QaH4Hrt8+av7Ulw6VEpDcwOpQZvavy/hihhW8SyAa4YgQU4RzAm3gCF6AgijurfUgIlDZ4+iiLEZS1986bBhHsCNimjEMLeapQyCClBzOSWiroY2EdxzeyvK4Pznk4EJsb5GVAq0trCZQiKA2ljkqlZ1JKK1Wl4bDWnELrKoKWfv9vqiqK2hFILegpR5ta+DMHt6pcilVrin1Nfb7tTcbyb3lT+m6HodlKT/6qgnL4REvz9/wevmO8/mM4/GIvu/hvUcIYZPfFN73M/A3vBqtkN4udBQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"빌드 파일 소스코드\"\n        title=\"빌드 파일 소스코드\"\n        src=\"/static/a5dce13e52437573b9833895894335e2/37523/build-file-source-code.png\"\n        srcset=\"/static/a5dce13e52437573b9833895894335e2/e9ff0/build-file-source-code.png 180w,\n/static/a5dce13e52437573b9833895894335e2/f21e7/build-file-source-code.png 360w,\n/static/a5dce13e52437573b9833895894335e2/37523/build-file-source-code.png 720w,\n/static/a5dce13e52437573b9833895894335e2/f7616/build-file-source-code.png 766w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>잘 모르겠다.</p>\n<p>빌드된 파일은 불필요한 데이터를 없애고 압축한 상태이기 때문에 브라우저는 잘 알아보지만 인간은 당연히 알아보기 힘들다.</p>\n<p>그래서 빌드 파일을 분석해주는 <code class=\"language-text\">webpack-bundle-analyzer</code>와 <code class=\"language-text\">cra-bundle-analyzer</code> 라이브러리를 사용했다.<br>\n라이브러리를 devDepenencies로 설치하고 명령어 <code class=\"language-text\">npx cra-bundle-analyzer</code>를 실행하면 다음과 같이 빌드 파일을 시각적으로 분석해준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+klEQVQoz3WS60/acBSG+dP3aVviksXMxGyLZtExuWmhSgHbQi+DFmmhLeUilzJERP+KZ+mPbGYf9v2c9z3nfd5M26zSbBRp3ZYwtCs6VpWeoxH4FnHoMIl7TEc+05HHeHhHNGjTv2vRbTewW7LYa6mX6PU8Qd8hY2oSer0gRK1mWQwOPJNR1GU2GZDMY1bLMavFiPl9yCT2hKjn6sI8FUt3NeWCwO+QsfSycDG1K1y7JtxHkct8GrBeTXl6THh+WrPb/mK3TVgnE3HtMGjTc1R+GjJGemEtx0AINisolXNUJU9Tlei5Ov2ezTj2WcxiHjcJL8+P7J4eiEKPge8wDFw6VgPHrqPVS9wqORo3WaKgS0arF/l48Iajw7ccHx2QPfvCj+8n3MgllGqZslSiUpGIogHXlSsKuXPkcp7Lwhm57FeODt9x/Ok9J58/sBj1yRiaRLV8Rk3OYuoVTP2attVgFPVYLScsFxM2D4m4cLtJmE0jwn6HwLMxdRm1VkAqnnIjfWMY3u1fNtQSli7h2AoDz2A87LK4D0Veu+2Kl+cHkeFmPSdZxNyPfcK+jedqtA1Z5N+s5/cZmnpZIP8f5eUfyssxi1kkgKSU/W7zH8qqcvEKpXVb/Es6HUqdA98mDt19D8e+6GLaw2Haw57x2kO1tKdczxH2XX4DWu1QkiW+SK4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"통합된 빌드 파일의 분석 결과\"\n        title=\"통합된 빌드 파일의 분석 결과\"\n        src=\"/static/e52a0bc88a80e26dbd4ce41da0e86348/37523/build-file-analysis-before-code-splitting.png\"\n        srcset=\"/static/e52a0bc88a80e26dbd4ce41da0e86348/e9ff0/build-file-analysis-before-code-splitting.png 180w,\n/static/e52a0bc88a80e26dbd4ce41da0e86348/f21e7/build-file-analysis-before-code-splitting.png 360w,\n/static/e52a0bc88a80e26dbd4ce41da0e86348/37523/build-file-analysis-before-code-splitting.png 720w,\n/static/e52a0bc88a80e26dbd4ce41da0e86348/302a4/build-file-analysis-before-code-splitting.png 1080w,\n/static/e52a0bc88a80e26dbd4ce41da0e86348/07a9c/build-file-analysis-before-code-splitting.png 1440w,\n/static/e52a0bc88a80e26dbd4ce41da0e86348/50966/build-file-analysis-before-code-splitting.png 1921w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>커다란 하나만 있는 건 잘못된 게 아니다.<br>\n따로 코드를 분할하지 않아 빌드 파일이 하나로 통합되어서 그런 것이다.</p>\n<h2 id=\"lazy와-suspense로-코드-분할하기\" style=\"position:relative;\"><a href=\"#lazy%EC%99%80-suspense%EB%A1%9C-%EC%BD%94%EB%93%9C-%EB%B6%84%ED%95%A0%ED%95%98%EA%B8%B0\" aria-label=\"lazy와 suspense로 코드 분할하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>lazy와 Suspense로 코드 분할하기</h2>\n<p><code class=\"language-text\">lazy</code> 함수와 <code class=\"language-text\">Suspense</code> 컴포넌트를 사용하면 지연 로딩할 코드를 분할할 수 있다.\n컴포넌트를 동적으로 import해 코드를 분할시키는 것이다.</p>\n<p>코드 분할 전의 코드는 이렇다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> AuthPage <span class=\"token keyword\">from</span> <span class=\"token string\">'src/pages/AuthPage'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> TodolistPage <span class=\"token keyword\">from</span> <span class=\"token string\">'src/pages/TodolistPage'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> Authorization <span class=\"token keyword\">from</span> <span class=\"token string\">'src/components/Authorization'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> LoginForm <span class=\"token keyword\">from</span> <span class=\"token string\">'src/components/LoginForm'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> RegisterForm <span class=\"token keyword\">from</span> <span class=\"token string\">'src/components/RegisterForm'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BrowserRouter</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Routes</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Authorization</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodolistPage</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AuthPage</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/login<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoginForm</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/register<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">RegisterForm</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Routes</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">BrowserRouter</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>로그인된 사용자인지를 판단하는 <code class=\"language-text\">Authorization</code> 컴포넌트는 어떤 페이지가 로딩되더라도 필요하다.<br>\n하지만 투두리스트 페이지, 로그인 페이지, 회원가입 페이지는 다른 페이지의 컴포넌트가 필요하지 않다.</p>\n<p>그래서 공통으로 사용되는 <code class=\"language-text\">Authorization</code> 컴포넌트를 제외한 나머지 컴포넌트들을 <code class=\"language-text\">lazy</code>와 <code class=\"language-text\">Suspense</code>를 사용해 동적으로 import했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> Authorization <span class=\"token keyword\">from</span> <span class=\"token string\">'src/components/Authorization'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> AuthPage <span class=\"token operator\">=</span> <span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/pages/AuthPage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> TodolistPage <span class=\"token operator\">=</span> <span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/pages/TodolistPage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> LoginForm <span class=\"token operator\">=</span> <span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/components/LoginForm'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> RegisterForm <span class=\"token operator\">=</span> <span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/components/RegisterForm'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BrowserRouter</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Suspense</span></span>\n        <span class=\"token attr-name\">fallback</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>h-screen<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Spinner</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">}</span></span>\n      <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Routes</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Authorization</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">TodolistPage</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AuthPage</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/login<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LoginForm</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n              </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Route</span></span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/register<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">element</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">RegisterForm</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n          </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Route</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Routes</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Suspense</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">BrowserRouter</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>코드가 분할되었는지 <code class=\"language-text\">cra-bundle-analyzer</code>로 확인해보자.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACE0lEQVQoz32SS08TARSF57cZ/4CJCxK3GlfogoUKCYmvREOQR0LptDyspFUoVJq00+kM7Uxnpu0MfQ1taS2lvBvQQHBjgpHkM1bCSlmd1T3n5pxPcPQQhuzFSvrIpwMUzUVce5V6UaJRUWi6azRdhXopwYYTpWQtYWsfsJJ+rKSIkZhhdPgrLwYueXj3AsFSZslIHizFz3omSCUf6R23qhrbDYtOM9fTVk1jsyz3wgrGR7LqLIbsQY+LvB08of/eJX23zxGya/OY8jR2OkA5G6ZejLNV09ht2Rx0KnT3qhzuuOy3C2xvGj3TSn4FR1vAlL0YssjgyzMeD8H9gV9/DbX4FJY6T9EMUytKfKnq7G4VOD5sctLd6mm7YdNwNaoFiVJ2BUsNkFV8pGMiwyNHPHh6wa2+7wipmIh3/AmesUGWgxOEQ1NEl+dQE2GikRApNU6laBJaEFkKicz7RggHJwjOvcE3+YzPoREevfvGnaGf9D3/gWAqsyirE2QSMziZRRwjQq20xk5rnU6rTPegyX6nev2h68QomGEs9T2JlTFSsWleh7uMRw/oD1x1aCW9OFqASm6ZRjlBu673OuzuuXT3axztbVx32PgzTD6Coy+QU32YST+vpBMW7VM+macIWXXuPyun2W6YN68sedATXkbL5xh2kzNdQsilApiyeDOHlX9wqFxxmPQz2Twj67Y5Lq/zG6ttP8oB9SmEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"코드 분할 후 빌드 파일의 분석 결과\"\n        title=\"코드 분할 후 빌드 파일의 분석 결과\"\n        src=\"/static/8a243929987a12101f116ff11c6f034a/37523/build-file-analysis-after-code-splitting.png\"\n        srcset=\"/static/8a243929987a12101f116ff11c6f034a/e9ff0/build-file-analysis-after-code-splitting.png 180w,\n/static/8a243929987a12101f116ff11c6f034a/f21e7/build-file-analysis-after-code-splitting.png 360w,\n/static/8a243929987a12101f116ff11c6f034a/37523/build-file-analysis-after-code-splitting.png 720w,\n/static/8a243929987a12101f116ff11c6f034a/302a4/build-file-analysis-after-code-splitting.png 1080w,\n/static/8a243929987a12101f116ff11c6f034a/07a9c/build-file-analysis-after-code-splitting.png 1440w,\n/static/8a243929987a12101f116ff11c6f034a/50966/build-file-analysis-after-code-splitting.png 1921w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>전과 다르게 빌드 파일이 여러 개로 쪼개져 있다.</p>\n<p>직접 웹사이트에 들어가 네트워크 탭을 확인하면 투두리스트에 필요한 코드만 로드된 걸 확인할 수 있다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABJ0AAASdAHeZh94AAACdElEQVQ4y6VUwXacMAzkT9Jsu9jGYDDGYGwwsJtNuz3k1v//lOmTyW7S9KWXHuZJluSRNTyRPT8/Y40R67Jg3TZs24Z1XfFyPeH68gunyzXFLpdLsiEEjOMI5waMYcYU6c6KZVkQY0Rmuw6NLNDWCnVVous6DIPDOZSIs8c0R4zOJbRaQ2uNvu8TmroGYznyPIdSKuWyUhvY0aPoI765M5Q2GKYFZpyTdfOKPkSYwSOsZ/jlhHm7YDld0LoAWVZ30uPxiGzZzng6XxCWC8x8RlxPCHFF70aEeYHpHYqqRqkaqKZFVWtItZ9FqRKhEBxSSpRliWxaF6jeYIgjrDUIPqTxnHOYQkijkTbGGMR5TpJM0wQ3DEnLECbYvsfoPbwPyHhdQXmLYy1QNureiUC+fLVVVd0tYc+/1bE8BxcSmeACZQowcM5RSAlV1zsxXVYqXeJCJJ9zgeMxTzGqJdKq2uOyUsjarofpLOpG45gzNLqF7Yd0tr3DHBf0gwPjIsVEIaFbk2BMh855VK1JhIUs949yvf7E+ekpvYBGJFLqTJqs64bvP65oGo2Hhy94fDzAh4A5xqS3aBQORuPw5YDD1wOylrpYiy69sklj0AhE2Gid4kRMfs4YGGMpT3GtWxQ0el3vOc6RkZj5K6iYdPxoKcf57t/iBIrLQkLy4l6b3Yr2wjf/M9wuCiHAOEuEhfiUkP2T5P3rbn4i5P9B+FGSvwhvHT92/ozgY10h3hEyhoy0uGlCKIriD59wy99znEMWIu1wRQsg5N5ACGTDMKTfDu3lvpsB1tq0w3T23qc9ph32nva9x2gazFZjekUwDVqjUdoOvwG/Tw+3i5vxMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"코드 분할 후 빌드 파일\"\n        title=\"코드 분할 후 빌드 파일\"\n        src=\"/static/7fa0fa831ff2259379fd19d4ace93b29/37523/build-file-after-code-splitting.png\"\n        srcset=\"/static/7fa0fa831ff2259379fd19d4ace93b29/e9ff0/build-file-after-code-splitting.png 180w,\n/static/7fa0fa831ff2259379fd19d4ace93b29/f21e7/build-file-after-code-splitting.png 360w,\n/static/7fa0fa831ff2259379fd19d4ace93b29/37523/build-file-after-code-splitting.png 720w,\n/static/7fa0fa831ff2259379fd19d4ace93b29/d48f1/build-file-after-code-splitting.png 796w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"코드-분할-결과\" style=\"position:relative;\"><a href=\"#%EC%BD%94%EB%93%9C-%EB%B6%84%ED%95%A0-%EA%B2%B0%EA%B3%BC\" aria-label=\"코드 분할 결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>코드 분할 결과</h2>\n<p>코드는 잘 분할되어 투두리스트 페이지에서는 투두리스트와 관련된 소스만 로드된다.</p>\n<p>그런데 빌드 파일의 용량을 확인해보면 코드 분할 전 하나의 빌드 파일일 때보다 코드 분할 후 여럿의 빌드 파일들의 용량이 더 크다.<br>\n코드 분할로 인해 페이지마다 불필요한 코드가 로드되지는 않으나, 코드 분할 전보다 로드해야 할 JavaScript 파일의 총 크기가 약간 늘어나 오히려 성능에 도움 되지 않는다.<br>\n이건 코드 분할로 인해 감소하는 코드 크기보다 코드 분할로 인해 추가된 코드의 크기가 더 크기 때문이라고 생각된다.</p>\n<p>그래서 코드가 크지 않다면 코드 분할을 적용하지 않는 것이 더 성능에 좋을 것 같다.</p>\n<p>프로젝트를 최적화한 내용은 <a href=\"https://github.com/heony704/ordinary-todolist/pull/8\">해당 Pull Request</a>에서 더 자세히 확인할 수 있다.</p>\n<hr>\n<p>참고</p>\n<ul>\n<li>프론트엔드 성능 최적화 가이드, 유동근 지음</li>\n<li><a href=\"https://react.dev/reference/react/lazy\">React lazy</a></li>\n<li><a href=\"https://react.dev/reference/react/Suspense\">React Suspense</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EB%B9%8C%EB%93%9C-%ED%8C%8C%EC%9D%BC-%EB%B6%84%EC%84%9D%ED%95%98%EA%B8%B0\">빌드 파일 분석하기</a></li>\n<li><a href=\"#lazy%EC%99%80-suspense%EB%A1%9C-%EC%BD%94%EB%93%9C-%EB%B6%84%ED%95%A0%ED%95%98%EA%B8%B0\">lazy와 Suspense로 코드 분할하기</a></li>\n<li><a href=\"#%EC%BD%94%EB%93%9C-%EB%B6%84%ED%95%A0-%EA%B2%B0%EA%B3%BC\">코드 분할 결과</a></li>\n</ul>\n</div>","excerpt":"React 프로젝트를 최적화하는 방법 중 코드 분할과 지연 로딩에 대해 알게 되었다. 💡 코드 분할(Code splitting)이란? 하나의 빌드 파일을 한 번에 다운로드하는 대신 여러 파일로 분할해 필요할 때만 다운로드하는 것이다.\n초기 리소스 다운로드 시간을 줄일 수 있다.\n불필요한 코드 또는 중복되는 코드 없이 적절한 사이즈의 코드가 적절한 타이밍에 로드되는 것이 중요하다. 💡 지연 로딩(Lazy loading)이란? 처음 페이지가 로드될 때가 아닌, 사용자가 서비스를 이용하는 중 해당 코드가 필요해지는 시점에 분할되어 있던 코드가 로드되어 실행되는 것이다.\n처음에 한 번에 로드되지 않고 지연되었다가 로드되므로 지연 로딩이다. 따로 코드 분할하지 않으면 통합된 하나의 빌드 파일을 가지게 되는데, 그러면 처음 페이지에 접속할 때 그 통합된 빌드 파일을 로드하기 때문에 당장 필요하지 않은 코드까지도 로드하게 된다. 내 투두리스트 프로젝트에서도 투두리스트 페이지에 들어가든, 로그인…","frontmatter":{"date":"October 29, 2023","title":"lazy와 Suspense로 코드 분할하고 로드 지연하기","categories":"react"},"fields":{"slug":"/react-code-splitting/"}},"next":{"id":"2facdfc2-dacb-5945-8dec-721ea4e07a94","html":"<p><a href=\"https://velog.io/@lky5697/5-best-practices-for-preventing-chaos-in-tailwind-css\">[번역] Tailwind CSS에서 혼란을 방지하기 위한 5가지 모범 사례</a>를 읽으면서 Tailwind CSS를 사용할 때 <code class=\"language-text\">@apply</code> 지시문을 남용하는 게 좋지 않다는 것을 알게 되었다.<br>\nTailwind CSS를 사용하던 프로젝트의 <code class=\"language-text\">@apply</code> 지시문을 줄이면서 느낀 것을 적어보려 한다.</p>\n<h2 id=\"bad-practice\" style=\"position:relative;\"><a href=\"#bad-practice\" aria-label=\"bad practice permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bad Practice</h2>\n<p>Tailwind CSS로 클래스 이름을 작성하다 보면 너무 길어져 지저분해 보일 때가 있다.<br>\n이때 <code class=\"language-text\">@layer</code>와 <code class=\"language-text\">@apply</code>를 사용하면 CSS 파일에 클래스를 새로 만들어 길고 지저분하게 늘어진 클래스 이름을 간결하게 만들 수 있다.</p>\n<p>이렇게 너무 길어 뭐가 뭔지 모르겠는 클래스 이름을,</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n  <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>w-full px-5 py-2.5 rounded-lg font-medium text-sm text-center focus:outline-none focus:ring-2 bg-primary-600 hover:bg-primary-700 disabled:bg-primary-600/50 text-white focus:ring-primary-300 dark:disabled:text-gray-400 dark:focus:ring-primary-800<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p><code class=\"language-text\">@layer</code>와 <code class=\"language-text\">@apply</code>를 사용해 버튼의 모양과 버튼의 색에 대한 클래스로 나눠 정의 해주면,</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> base<span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> components<span class=\"token punctuation\">;</span></span>\n<span class=\"token atrule\"><span class=\"token rule\">@tailwind</span> utilities<span class=\"token punctuation\">;</span></span>\n\n<span class=\"token atrule\"><span class=\"token rule\">@layer</span> components</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">.button-rounded-lg</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token atrule\"><span class=\"token rule\">@apply</span> w-full px-5 py-2.5 rounded-lg<span class=\"token punctuation\">;</span></span>\n    <span class=\"token atrule\"><span class=\"token rule\">@apply</span> font-medium text-sm text-center<span class=\"token punctuation\">;</span></span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">.button-primary</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token atrule\"><span class=\"token rule\">@apply</span> <span class=\"token property\">focus</span><span class=\"token punctuation\">:</span>outline-none <span class=\"token property\">focus</span><span class=\"token punctuation\">:</span>ring-2<span class=\"token punctuation\">;</span></span>\n    <span class=\"token atrule\"><span class=\"token rule\">@apply</span> bg-primary-600 <span class=\"token property\">hover</span><span class=\"token punctuation\">:</span>bg-primary-700 <span class=\"token property\">disabled</span><span class=\"token punctuation\">:</span>bg-primary-600/50<span class=\"token punctuation\">;</span></span>\n    <span class=\"token atrule\"><span class=\"token rule\">@apply</span> text-white <span class=\"token property\">focus</span><span class=\"token punctuation\">:</span>ring-primary-300<span class=\"token punctuation\">;</span></span>\n    <span class=\"token atrule\"><span class=\"token rule\">@apply</span> <span class=\"token property\">dark</span><span class=\"token punctuation\">:</span><span class=\"token property\">disabled</span><span class=\"token punctuation\">:</span>text-gray-400 <span class=\"token property\">dark</span><span class=\"token punctuation\">:</span><span class=\"token property\">focus</span><span class=\"token punctuation\">:</span>ring-primary-800<span class=\"token punctuation\">;</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 알아보기도 쉽고 간결하게 만들 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">disabled</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>disabled<span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-rounded-lg button-primary<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>와! 가독성도 좋고 만들어 둔 클래스를 재사용할 수 있으니 너무 좋다!<br>\n이렇게 하면 Tailwind CSS의 스타일을 알아보기 힘든 단점도 보완돼!<br>\n라고 생각했지만, 이 방법은 좋은 방법이 아니었다.</p>\n<h2 id=\"추상화를-위해-apply-지시문을-남용하지-말기\" style=\"position:relative;\"><a href=\"#%EC%B6%94%EC%83%81%ED%99%94%EB%A5%BC-%EC%9C%84%ED%95%B4-apply-%EC%A7%80%EC%8B%9C%EB%AC%B8%EC%9D%84-%EB%82%A8%EC%9A%A9%ED%95%98%EC%A7%80-%EB%A7%90%EA%B8%B0\" aria-label=\"추상화를 위해 apply 지시문을 남용하지 말기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>추상화를 위해 @apply 지시문을 남용하지 말기</h2>\n<p><code class=\"language-text\">@apply</code>를 코드를 깔끔하게 만들기 위해 사용하면 안된다.</p>\n<p>Tailwind CSS의 가장 큰 장점은 CSS 파일을 만들 필요 없이 HTML 안에서 클래스 이름을 통해 쉽게 스타일을 적용하는 것이다.<br>\n그런데 따로 CSS 파일을 만들어 클래스를 만들고 관리하는 것은 이런 Tailwind CSS의 장점을 퇴색시킨다.<br>\n스타일을 적용할 수 있는 방법이 두 가지가 되어 혼란을 야기하기 때문에 Tailwind CSS 없이 CSS 파일로만 스타일을 적용하는 것보다 유지보수가 더 힘들어진다.</p>\n<p>Tailwind CSS를 사용하면서 CSS 파일에 별도의 클래스를 만들기 시작하면, 스타일 변경이 있을 때 컴포넌트 파일과 CSS 파일을 돌아다니며 확인해야 한다.<br>\nCSS 파일이 방대해질수록 어떤 스타일이 관여되었는지 확인하기 어려워진다.<br>\n한눈에 스타일이 파악되지 않고 특히 <code class=\"language-text\">@layer</code>의 base, components, utilities는 각각 우선순위가 다르기 때문에 혼란을 가중한다.</p>\n<p>따라서 버튼처럼 매우 작고 다양한 곳에서 사용되는 스타일이 아니라면 <code class=\"language-text\">@apply</code>를 통해 별도의 클래스를 만드는 것은 추천되지 않는다.<br>\n또 리액트처럼 컴포넌트 중심의 프로젝트는 글로벌한 CSS 클래스를 만드는 것보다 컴포넌트에 스타일을 적용하고 컴포넌트를 재사용하는 것이 훨씬 좋은 선택이다.</p>\n<p>해당 내용은 <a href=\"https://tailwindcss.com/docs/reusing-styles#avoiding-premature-abstraction\">Tailwind CSS 공식 문서</a>에서도 확인할 수 있다.</p>\n<h2 id=\"apply-지시문-최소화하기\" style=\"position:relative;\"><a href=\"#apply-%EC%A7%80%EC%8B%9C%EB%AC%B8-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EA%B8%B0\" aria-label=\"apply 지시문 최소화하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@apply 지시문 최소화하기</h2>\n<p>Tailwind CSS를 사용한 프로젝트를 보니 <code class=\"language-text\">@apply</code>가 참 많아 다음과 같이 최소화했다.</p>\n<h3 id=\"1-indexcss에-정의된-components와-utilities를-전부-제거\" style=\"position:relative;\"><a href=\"#1-indexcss%EC%97%90-%EC%A0%95%EC%9D%98%EB%90%9C-components%EC%99%80-utilities%EB%A5%BC-%EC%A0%84%EB%B6%80-%EC%A0%9C%EA%B1%B0\" aria-label=\"1 indexcss에 정의된 components와 utilities를 전부 제거 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. index.css에 정의된 components와 utilities를 전부 제거</h3>\n<p><code class=\"language-text\">index.css</code>에 <code class=\"language-text\">@apply</code>로 정의한 클래스 대부분이 코드 가독성을 높이기 위해 한두 번 사용되는 스타일이었다.\n이런 한두 번 사용되는 클래스들은 과감하게 제거하고 다시 원래 컴포넌트 스타일에 입력해줬다.</p>\n<h3 id=\"2-자주-사용된-icon-button-클래스는-iconbutton-컴포넌트로-대체\" style=\"position:relative;\"><a href=\"#2-%EC%9E%90%EC%A3%BC-%EC%82%AC%EC%9A%A9%EB%90%9C-icon-button-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%8A%94-iconbutton-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%A1%9C-%EB%8C%80%EC%B2%B4\" aria-label=\"2 자주 사용된 icon button 클래스는 iconbutton 컴포넌트로 대체 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 자주 사용된 icon-button 클래스는 IconButton 컴포넌트로 대체</h3>\n<p><code class=\"language-text\">icon-button</code> 클래스는 네 번 사용될 정도로 재사용성이 높아 <code class=\"language-text\">IconButton</code> 컴포넌트를 만들어 대체했다.</p>\n<p>더 자세한 내용은 <a href=\"https://github.com/heony704/ordinary-todolist/pull/7\">해당 Pull Request</a>에서 확인할 수 있다.</p>\n<p>이렇게 수정하다 보니 이 전엔 나름 가독성 높이겠다고 했던 행동이 헛수고가 되었다.<br>\n사용하는 프레임워크의 개념에 대해 정확히 파악하고 잊지 않는 것이 중요한 것 같다.</p>\n<hr>\n<p>참고</p>\n<ul>\n<li><a href=\"https://velog.io/@lky5697/5-best-practices-for-preventing-chaos-in-tailwind-css\">[번역] Tailwind CSS에서 혼란을 방지하기 위한 5가지 모범 사례</a></li>\n<li><a href=\"https://evilmartians.com/chronicles/5-best-practices-for-preventing-chaos-in-tailwind-css\">5 best practices for preventing chaos in Tailwind CSS</a></li>\n<li><a href=\"https://tailwindcss.com/docs/reusing-styles#avoiding-premature-abstraction\">Tailwind CSS - Avoiding premature abstraction</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#bad-practice\">Bad Practice</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B6%94%EC%83%81%ED%99%94%EB%A5%BC-%EC%9C%84%ED%95%B4-apply-%EC%A7%80%EC%8B%9C%EB%AC%B8%EC%9D%84-%EB%82%A8%EC%9A%A9%ED%95%98%EC%A7%80-%EB%A7%90%EA%B8%B0\">추상화를 위해 @apply 지시문을 남용하지 말기</a></p>\n</li>\n<li>\n<p><a href=\"#apply-%EC%A7%80%EC%8B%9C%EB%AC%B8-%EC%B5%9C%EC%86%8C%ED%99%94%ED%95%98%EA%B8%B0\">@apply 지시문 최소화하기</a></p>\n<ul>\n<li><a href=\"#1-indexcss%EC%97%90-%EC%A0%95%EC%9D%98%EB%90%9C-components%EC%99%80-utilities%EB%A5%BC-%EC%A0%84%EB%B6%80-%EC%A0%9C%EA%B1%B0\">1. index.css에 정의된 components와 utilities를 전부 제거</a></li>\n<li><a href=\"#2-%EC%9E%90%EC%A3%BC-%EC%82%AC%EC%9A%A9%EB%90%9C-icon-button-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%8A%94-iconbutton-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%A1%9C-%EB%8C%80%EC%B2%B4\">2. 자주 사용된 icon-button 클래스는 IconButton 컴포넌트로 대체</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"October 28, 2023","title":"Tailwind CSS @apply 지시문 최소화하기","categories":"react"},"fields":{"slug":"/minimize-tailwindcss-apply/"}},"prev":{"id":"5557ec96-630e-50e6-aece-c6351c181fac","html":"<p>React 프로젝트에 이미지를 사이즈 생각 안하고 넣었더니 로드하는 데 시간이 오래 걸려 이미지 사이즈를 최적화했다.</p>\n<h2 id=\"이미지-사이즈-줄이기\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%82%AC%EC%9D%B4%EC%A6%88-%EC%A4%84%EC%9D%B4%EA%B8%B0\" aria-label=\"이미지 사이즈 줄이기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이미지 사이즈 줄이기</h2>\n<p>이미지 크기가 너무 크면 로드하는 데 시간이 걸리고 이미지 크기가 너무 작다면 화질이 저하된다.\n그렇다면 이미지는 어느 정도 크기여야 적당할까?</p>\n<p>나는 다음 말에 설득되어 이미지가 화면에서 차지하는 픽셀의 두 배 정도 크기로 이미지 사이즈를 조절했다.</p>\n<blockquote>\n<p>단순히 화면에 표시되는 사이즈로 만들어야 한다고 생각할 수 있습니다. 물론 틀린 말은 아닙니다. 하지만 요즘 사용되는 레티나 디스플레이는 같은 공간(픽셀)에 더 많은 픽셀을 그릴 수 있기 때문에, 너비 기준으로 두 배 정도 큰 이미지를 사용하는 것이 적절합니다.<br>\n- 프론트엔드 성능 최적화 가이드, 유동근 지음</p>\n</blockquote>\n<p>화면에서 최대 너비 384px, 높이 240px로 표시되는 이미지라면 원본 이미지 사이즈를 너비 768px, 높이 480px 정도 되도록 줄였다.<br>\n이미지 화질이 그렇게 중요하지 않은 프로젝트라서 그런지 화면 표시 픽셀 기준 두 배 크기로 줄여도 크게 달라 보이지 않았다.</p>\n<p>이렇게 이미지 사이즈를 줄인 결과, 프로젝트에 사용된 총 34개의 이미지 파일 크기는 14.3MB에서 4.9MB로 줄었다.</p>\n<h2 id=\"jpg-png-대신-webp-사용하기\" style=\"position:relative;\"><a href=\"#jpg-png-%EB%8C%80%EC%8B%A0-webp-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"jpg png 대신 webp 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JPG, PNG 대신 WebP 사용하기</h2>\n<p>사용된 이미지의 포맷이 JPG, 혹은 PNG라면 WebP를 사용해 파일 크기를 더 줄일 수 있다.</p>\n<p>WebP는 구글에서 개발한 이미지 포맷으로, 손실 압축과 비손실 압축을 모두 제공하는 최신 이미지 포맷이다.\n이미지 품질이 같을 때 파일 크기가 JPG와 PNG에 비해 훨씬 작다.</p>\n<h3 id=\"이미지-포맷-비교\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%8F%AC%EB%A7%B7-%EB%B9%84%EA%B5%90\" aria-label=\"이미지 포맷 비교 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이미지 포맷 비교</h3>\n<ul>\n<li>JPG: 손실 압축, 그 만큼 작은 사이즈</li>\n<li>PNG: 비손실 압축, 그 만큼 큰 사이즈</li>\n<li>WebP: 손실 압축 &#x26; 비손실 압축, 작은 사이즈, 하지만 호환성 문제 존재</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>비교</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>사이즈</td>\n<td>PNG > JPG > WebP</td>\n</tr>\n<tr>\n<td>화질</td>\n<td>PNG = WebP > JPG</td>\n</tr>\n<tr>\n<td>호환성</td>\n<td>PNG = JPG > WebP</td>\n</tr>\n</tbody>\n</table>\n<p>이미지 포맷을 JPG, PNG에서 WebP로 변환해 총 34개의 이미지 파일 크기를 4.9MB에서 1.1MB로 감소시켰다.</p>\n<h2 id=\"picture-태그를-사용해-다양한-포맷의-이미지-제공하기\" style=\"position:relative;\"><a href=\"#picture-%ED%83%9C%EA%B7%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4-%EB%8B%A4%EC%96%91%ED%95%9C-%ED%8F%AC%EB%A7%B7%EC%9D%98-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%A0%9C%EA%B3%B5%ED%95%98%EA%B8%B0\" aria-label=\"picture 태그를 사용해 다양한 포맷의 이미지 제공하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>picture 태그를 사용해 다양한 포맷의 이미지 제공하기</h2>\n<p>WebP는 압축 효율이 높아 가장 작은 사이즈로 이미지를 제공할 수 있지만 최신 이미지 포맷인 만큼 호환성 문제가 있다.<br>\n그래서 WebP를 지원하는 브라우저는 WebP 이미지를, WebP를 지원하지 않는 브라우저는 JPG나 PNG 이미지를 제공하도록 해줘야 한다.</p>\n<p><code class=\"language-text\">picture</code> 태그를 사용하면 다양한 포맷의 이미지를 제공할 수 있다.<br>\n브라우저는 <code class=\"language-text\">source</code> 요소 중 사용할 수 있는 요소가 있다면 사용하고 만약 사용할 수 없거나 브라우저가 <code class=\"language-text\">picture</code> 요소를 지원하지 않는다면 <code class=\"language-text\">img</code> 요소를 사용한다.<br>\n이걸 이용해 WebP를 지원하는 브라우저는 WebP 이미지를, WebP 이미지를 지원하지 않는 브라우저는 JPG나 PNG 이미지를 보여주도록 했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Picture</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> imgSrc <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>picture</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">srcSet</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ImgSrc<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.webp</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>image/webp<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>ImgSrc<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.jpg</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span></span> <span class=\"token attr-name\">alt</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>name<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>picture</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>참고로 <code class=\"language-text\">picture</code> 요소 안에 <code class=\"language-text\">img</code> 요소가 없으면 <code class=\"language-text\">source</code> 요소가 몇 개 있든 아무것도 표시되지 않는다.<br>\n이미지에 스타일이나 기타 속성을 설정하고 싶으면 <code class=\"language-text\">img</code> 요소에 설정해야 한다.</p>\n<h2 id=\"최적화-결과-비교\" style=\"position:relative;\"><a href=\"#%EC%B5%9C%EC%A0%81%ED%99%94-%EA%B2%B0%EA%B3%BC-%EB%B9%84%EA%B5%90\" aria-label=\"최적화 결과 비교 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>최적화 결과 비교</h2>\n<p>프로젝트에 사용된 총 34개의 이미지 파일을 최적화하면서 크기가 얼마나 감소했는지 비교해봤다.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>파일 크기</th>\n<th>기존에 비해 감소한 비율</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>기존</td>\n<td>14.3MB</td>\n<td>-</td>\n</tr>\n<tr>\n<td>사이즈 감소</td>\n<td>4.9MB</td>\n<td>66%</td>\n</tr>\n<tr>\n<td>WebP로 변환</td>\n<td>1.1MB</td>\n<td>92%</td>\n</tr>\n</tbody>\n</table>\n<p>최적화를 통해 이미지 크기가 최대 92% 감소했다!<br>\n실제로 웹사이트를 작동시켜 봤을 때도 이미지가 최적화 전보다 훨씬 빠르게 로드되었다.</p>\n<p><a href=\"https://github.com/heony704/prove-your-cat-love/pull/4\">해당 Pull Request</a>를 통해 프로젝트에서 어떻게 이미지 사이즈 최적화했는지 확인할 수 있다.</p>\n<hr>\n<p>참고</p>\n<ul>\n<li>프론트엔드 성능 최적화 가이드, 유동근 지음</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%82%AC%EC%9D%B4%EC%A6%88-%EC%A4%84%EC%9D%B4%EA%B8%B0\">이미지 사이즈 줄이기</a></p>\n</li>\n<li>\n<p><a href=\"#jpg-png-%EB%8C%80%EC%8B%A0-webp-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">JPG, PNG 대신 WebP 사용하기</a></p>\n<ul>\n<li><a href=\"#%EC%9D%B4%EB%AF%B8%EC%A7%80-%ED%8F%AC%EB%A7%B7-%EB%B9%84%EA%B5%90\">이미지 포맷 비교</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#picture-%ED%83%9C%EA%B7%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4-%EB%8B%A4%EC%96%91%ED%95%9C-%ED%8F%AC%EB%A7%B7%EC%9D%98-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%A0%9C%EA%B3%B5%ED%95%98%EA%B8%B0\">picture 태그를 사용해 다양한 포맷의 이미지 제공하기</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B5%9C%EC%A0%81%ED%99%94-%EA%B2%B0%EA%B3%BC-%EB%B9%84%EA%B5%90\">최적화 결과 비교</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"October 30, 2023","title":"리액트 이미지 사이즈 최적화","categories":"react"},"fields":{"slug":"/react-image-size-optimization/"}},"site":{"siteMetadata":{"siteUrl":"https://heony704.github.io","comments":{"utterances":{"repo":"heony704/heony704.github.io"}}}}},"pageContext":{"slug":"/react-code-splitting/","nextSlug":"/minimize-tailwindcss-apply/","prevSlug":"/react-image-size-optimization/"}},"staticQueryHashes":["161131432","1956554647","2938748437"]}